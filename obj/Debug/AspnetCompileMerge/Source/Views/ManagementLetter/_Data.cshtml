@model List<StrawmanApp.Entities.ManagementLetterModel>
@{
    string _RED = StrawmanApp.Helpers.StrawmanConstants.Colors.Red;
    string _GREEN = StrawmanApp.Helpers.StrawmanConstants.Colors.Green;
    string style_color;
    string buttom_color;
<table class="table" style="display:table;text-align:center;">
<tbody>
    <tr class="table-row" style="display:table-row;font-weight:bold;">
        <td rowspan="3" class="table-cell" style="display:table-cell;border-bottom-color:transparent;">
            @ViewBag.HeadTitle
        </td>
        <td colspan= "3" class="table-cell" style="display:table-cell">YTD</td>
        <td colspan= "3" class="table-cell" style="display:table-cell">LATEST 4W</td>
    </tr>
    <tr style="font-weight:bold;">
        <td class="table-cell" style="display:table-cell;width:140px;">VALUE</td>
        <td class="table-cell" style="display:table-cell;width:140px;">SHARE</td>
        <td class="table-cell" style="display:table-cell;width:140px;">SALES</td>
        <td class="table-cell" style="display:table-cell;width:140px;">VALUE</td>
        <td class="table-cell" style="display:table-cell;width:140px;">SHARE</td>
        <td class="table-cell" style="display:table-cell;width:140px;">SALES</td>
    </tr>
    <tr style="font-weight:bold;">
        <td class="table-cell" style="display:table-cell">SHARE</td>
        <td class="table-cell" style="display:table-cell">Chg VS YA</td>
        <td class="table-cell" style="display:table-cell">Chg VS YA</td>
        <td class="table-cell" style="display:table-cell">SHARE</td>
        <td class="table-cell" style="display:table-cell">Chg VS YA</td>
        <td class="table-cell" style="display:table-cell">Chg VS YA</td>
    </tr>
    <tr style="font-weight:bold;">
        <td class="table-cell" style="display:table-cell;border-bottom-color:transparent;">@ViewBag.PeriodText</td>
        <td class="table-cell" style="display:table-cell">(%)</td>
        <td class="table-cell" style="display:table-cell">(SH pts)</td>
        <td class="table-cell" style="display:table-cell">(%)</td>
        <td class="table-cell" style="display:table-cell">(%)</td>
        <td class="table-cell" style="display:table-cell">(SH pts)</td>
        <td class="table-cell" style="display:table-cell">(%)</td>
    </tr>
    <tr style="font-weight:bold;">
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;">&nbsp;</td>
    </tr> 
    <tr style="font-weight:bold;">
        <td class="table-cell" style="display:table-cell;border-bottom-color: transparent;">@ViewBag.Country</td>
        <td class="table-cell" style="display:table-cell;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell;border-right-color:transparent;">&nbsp;</td>
        <td class="table-cell" style="display:table-cell">&nbsp;</td>
    </tr>     
@if(Model != null){
    foreach (StrawmanApp.Entities.ManagementLetterModel item in Model)
    {
        buttom_color = "";
        style_color = "";
        if (Model.IndexOf(item) != Model.Count -1){
            buttom_color = "border-bottom-color: transparent";
        }
        <tr class="table-row" style="display:table-row">
            <td class="table-cell" style="display:table-cell; font-weight:bold;@buttom_color">@Html.DisplayFor(m=>item.name)</td>
            <td class="table-cell" style="display:table-cell">@Html.DisplayFor(m=>item.ytd_col1)</td>
            @if(item.ytd_col2 != null){
                style_color = "color:" + ((item.ytd_col2 < 0) ? _RED : _GREEN);
            }
            <td class="table-cell" style="display:table-cell;@style_color">@Html.DisplayFor(m=>item.ytd_col2)</td>
            @if(item.ytd_col3 != null){
                style_color = "color:" + ((item.ytd_col3 < 0) ? _RED : _GREEN);
            }
            <td class="table-cell" style="display:table-cell;@style_color">@Html.DisplayFor(m=>item.ytd_col3)</td>
            <td class="table-cell" style="display:table-cell">@Html.DisplayFor(m=>item.latest_col1)</td>
            @if (item.latest_col2 != null)
            {
                style_color = "color:" + ((item.latest_col2 < 0) ? _RED : _GREEN);
            }
            <td class="table-cell" style="display:table-cell;@style_color">@Html.DisplayFor(m=>item.latest_col2)</td>
            @if (item.latest_col3 != null)
            {
                style_color = "color:" + ((item.latest_col3 < 0) ? _RED : _GREEN);
            }
            <td class="table-cell" style="display:table-cell;@style_color">@Html.DisplayFor(m=>item.latest_col3)</td>
        </tr>
    }
}
</tbody>
</table>
}